<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>PhÃ¢n tÃ­ch Khoáº£ng Sá»‘</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 30px auto;
    }

    textarea, button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin-top: 10px;
    }

    #output {
      margin-top: 20px;
      white-space: pre-line;
      background: #f5f5f5;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      min-height: 100px;
    }

    .btn-copy {
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 10px;
    }

    .btn-copy:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <h2>ğŸ”¢ DÃ¡n cá»™t sá»‘ tá»« Excel</h2>
  <textarea id="input" rows="10" placeholder="DÃ¡n cá»™t sá»‘ vÃ o Ä‘Ã¢y, má»—i dÃ²ng 1 sá»‘ (theo thá»© tá»± tÄƒng dáº§n)"></textarea>
  <button onclick="generateRanges()">ğŸ“Š Táº¡o Khoáº£ng</button>

  <h3>ğŸ“„ Káº¿t quáº£:</h3>
  <div id="output"></div>
  <button class="btn-copy" onclick="copyOutput()">ğŸ“‹ Sao chÃ©p káº¿t quáº£</button>

  <script>
    function generateRanges() {
      const inputLines = document.getElementById("input").value.trim().split('\n');
      const numbers = inputLines
        .map(line => parseInt(line.trim()))
        .filter(n => !isNaN(n));

      // Kiá»ƒm tra rá»—ng
      if (numbers.length === 0) {
        document.getElementById("output").textContent = "âš ï¸ Vui lÃ²ng nháº­p Ã­t nháº¥t 1 sá»‘!";
        return;
      }

      // Kiá»ƒm tra tÄƒng dáº§n
      for (let i = 1; i < numbers.length; i++) {
        if (numbers[i] <= numbers[i - 1]) {
          document.getElementById("output").textContent = "âŒ Lá»—i: DÃ£y sá»‘ khÃ´ng tÄƒng dáº§n táº¡i dÃ²ng " + (i + 1);
          return;
        }
      }

    const result = [];
      for (let i = 0; i < numbers.length; i++) {
        const current = numbers[i];
        if (i === numbers.length - 1) {
          result.push(formatNumber(current));
          break;
        }
        const next = numbers[i + 1];
        if (current + 1 === next) {
          result.push(formatNumber(current));
        } else {
          result.push(`${formatNumber(current)}-${formatNumber(next - 1)}`);
        }
      }

      document.getElementById("output").textContent = result.join('\n');
    }

    function formatNumber(n) {
      return n.toString().padStart(2, '0');
    }

    function copyOutput() {
      const outputText = document.getElementById("output").textContent;
      if (!outputText.trim()) {
        alert("âš ï¸ KhÃ´ng cÃ³ gÃ¬ Ä‘á»ƒ sao chÃ©p!");
        return;
      }
      navigator.clipboard.writeText(outputText)
        .then(() => alert("âœ… ÄÃ£ sao chÃ©p káº¿t quáº£ vÃ o clipboard!"))
        .catch(err => alert("âŒ Lá»—i khi sao chÃ©p: " + err));
    }
  </script>
</body>
</html>
